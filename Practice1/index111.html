<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <title>Hello, world!</title>
  </head>

  <body>
    <form onsubmit="send(event)" novalidate>
      <div class="m-3">
        <label for="exampleInputEmail1" class="form-label">Name</label>
        <input
          type="text"
          class="form-control"
          id="exampleInputEmail1"
          name="fnameUser"
        />
      </div>
      <div class="m-3">
        <label for="exampleInputEmail1" class="form-label">LastName</label>
        <input
          type="text"
          class="form-control"
          id="exampleInputEmail1"
          name="lnameUser"
          aria-describedby="emailHelp"
        />
      </div>
      <div class="m-3">
        <label for="exampleInputEmail1" class="form-label">Email </label>
        <input
          type="email"
          class="form-control"
          id="exampleInputEmail1"
          aria-describedby="emailHelp"
          name="Email"
        />
        <div id="emailHelp" class="form-text">
          We'll never share your email with anyone else.
        </div>
      </div>

      <div class="m-3">
        <label for="exampleInputEmail1" class="form-label">phone</label>
        <input
          type="tel"
          class="form-control"
          id="exampleInputEmail1"
          name="phone"
          aria-describedby="emailHelp"
        />
      </div>
      <div class="m-3">
        <label for="exampleInputEmail1" class="form-label">National</label>
        <select name="select" class="w-100 my-3">
          <option selected>Open this select menu</option>
          <option value="Iran">Iran</option>
          <option value="Iraq">Iraq</option>
          <option value="India">India</option>
        </select>
      </div>
      <div class="form-check m-3">
        <span>
          <input
            type="radio"
            class="form-check-input"
            id="exampleCheck1"
            name="male"
            value="male"
          />
          <label class="form-check-label" for="exampleCheck1">male</label>
        </span>
      </div>
      <div class="form-check m-3">
        <span class="m-2">
          <input
            type="radio"
            class="form-check-input"
            id="exampleCheck1"
            name="fmale"
            value="fmale"
          />
          <label class="form-check-label" for="exampleCheck1"
            >fmale</label
          ></span
        >
      </div>

      <button type="submit" class="btn btn-primary m-3">Submit</button>
    </form>
    <table class="table m-5">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">phone</th>
          <th scope="col">Gender</th>
          <th scope="col">Nationality</th>
          <th scope="col">Active</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      function erorrMes(input, text) {
        let erorr = document.createElement("div");
        erorr.classList.add("invalid-feedback");
        erorr.innerText = text;
        input.parentElement.appendChild(erorr);
      }

      function invalidation(value, name, element) {
        switch (name) {
          case "fnameUser":
            if (!value) {
              erorrMes(element, "Esmeto vared kon!");
              return false;
            }
            if (value.length > 20) {
              erorrMes(element, "Esmet ziade");
              return false;
            }
            return true;
          case "lnameUser":
            if (!value) {
              erorrMes(element, "familto vared kon!");
              return false;
            }
            return true;

          case "Email":
            const emailRex = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g;
            if (!value) {
              erorrMes(element, "emailto vared kon!");
              return false;
            }
            if (!emailRex.test(value)) {
              erorrMes(element, "emailto dorost vared kon!");
              return false;
            }

            return true;
          case "phone":
            const phoneRex = /^(09)+\d{9}$/g;
            if (!value) {
              erorrMes(element, "shomarato vared kon!");
              return false;
            }
            if (!phoneRex.test(value)) {
              erorrMes(element, "shomarato dorost vared kon!");
              return false;
            }
            return true;

          default:
            return true;
        }
      }

      let counter = 0;
      function send(e) {
        const target = e.target;
        e.preventDefault();
        const items = {};
        let flag = true;
        document
          .querySelectorAll(".invalid-feedback")
          .forEach((el) => el.remove());
        for (let i of target) {
          if (i.name === "male" || i.name === "fmale") {
            items[i.name] = i.checked;
          } else {
            items[i.name] = i.value;
            if (!invalidation(i.value, i.name, i)) {
              flag = false;
              i.classList.add("is-invalid");
            } else {
              i.classList.remove("is-invalid");
            }
          }
        }
        if (flag) {
          const trEle = document.createElement("tr");
          const counterTdEle = document.createElement("td");
          const nameTdEle = document.createElement("td");
          const emailTdEle = document.createElement("td");
          const phoneTdEl = document.createElement("td");
          const selectTdEle = document.createElement("td");
          const checkboxTdEle = document.createElement("td");
          const deleteTdEle = document.createElement("td");

          trEle.appendChild(counterTdEle);
          trEle.appendChild(nameTdEle);
          trEle.appendChild(emailTdEle);
          trEle.appendChild(phoneTdEl);
          trEle.appendChild(checkboxTdEle);
          trEle.appendChild(selectTdEle);
          trEle.appendChild(deleteTdEle);

          const tbody = document.querySelector("tbody");
          counterTdEle.innerText = ++counter;
          nameTdEle.innerText = items.fnameUser + " " + items.lnameUser;
          emailTdEle.innerText = items.Email;
          phoneTdEl.innerText = items.phone;
          selectTdEle.innerText = items.select;
          if (items.male) {
            checkboxTdEle.innerText = "male";
          }
          if (items.fmale) {
            checkboxTdEle.innerText = "fmale";
          }
          const delBtn = document.createElement("button");
          delBtn.onclick = function (e) {
            e.target.parentElement.parentElement.remove();
          };
          delBtn.innerText = "delete";
          deleteTdEle.appendChild(delBtn);

          tbody.appendChild(trEle);
        }
      }
    </script>
  </body>
</html>
